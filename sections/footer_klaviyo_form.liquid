<div class="klaviyo_form_footer_section" id="{{section.id}}">
    <div class="container">  
        <form id="email_signup_{{section.settings.klaviyo_list_id}}" class="klaviyo_gdpr_embed_{{section.settings.klaviyo_list_id}}" action="//manage.kmail-lists.com/subscriptions/subscribe" data-ajax-submit="//manage.kmail-lists.com/ajax/subscriptions/subscribe" method="GET" target="_blank" novalidate="novalidate">
            <input type="hidden" name="g" value="{{section.settings.klaviyo_list_id}}">
            <input type="hidden" name="$fields" value="$consent">
            <input type="hidden" name="$list_fields" value="$consent">
            
            <div class="row align-items-center justify-content-center">
                <div class="col-12 col-md-4 text-center">
                    <p class="catch">Catch</p>
                    <h3 class="title">The Lab Report<sup>&trade;</sup></h3>
                    <div class="klaviyo_form_actions d-none d-md-block">
                        <button type="submit" class="klaviyo_submit_button btn btn-primary">Subscribe</button> 
                    </div>
                </div>
                
                <div class="col-12 col-md-8">
                    <div class="klaviyo_messages">
                        <div class="success_message" style="display:none;"></div>
                        <div class="error_message" style="display:none;"></div>
                    </div>    
                    
                    <div class="klaviyo_field_group">
                        <div class="row">
                            <div class="form-group col-6">
                                <label for="k_id_email" class="d-none">Newsletter Sign Up</label>
                                <input class="form-control" type="email" value="" name="email" id="k_id_email" placeholder="Email Address" autocomplete="email" required />    
                            </div>
                            
                            <div class="form-group col-6">
                                <label for="k_id_birthday" class="d-none">Newsletter Sign Up</label>
                                <input class="form-control" type="email" value="" name="birthday" id="k_id_birthday" placeholder="Birthday" autocomplete="bday" />    
                            </div>
                            
                            <div class="form-group col-12">
                                <label for="k_id_phone" class="d-none">Newsletter Sign Up</label>
                                <input class="form-control" type="phone" value="" name="phone" id="k_id_phone" placeholder="Mobile Number" />    
                            </div>
                        </div>
                        
                        <div class="klaviyo_field_group klaviyo_form_actions">
                            <div class="klaviyo_helptext klaviyo_gdpr_text">
                                {{ section.settings.disclaimer }}
                            </div>
                        </div>
                    
                    </div>
                    
                    
                    
                    <div class="klaviyo_form_actions d-block d-md-none">
                        <button type="submit" class="klaviyo_submit_button btn btn-primary btn-block mt-3">Subscribe</button> 
                    </div>     
                </div>
            </div>
        </form>
    </div>
</div>

<script type="text/javascript" src="//www.klaviyo.com/media/js/public/klaviyo_subscribe.js" defer></script>
<script type="text/javascript">
function initKlaviyoForm() {
    var input = document.getElementById("k_id_phone");

    window.intlTelInput(input, {
    });

    KlaviyoSubscribe.attachToForms('#email_signup_{{section.settings.klaviyo_list_id}}', {
        success: function ($form) {
        // `$form` is a jQuery wrapper around the form that was submitted. This makes it easy to get the email address or form fields.
            var email = $form.find('[name="email"]').val();
            _learnq.push(['identify', { $email: email }]);
            _learnq.push(['track', 'Signed Up for Newsletter']);
        }
    });
}

window.addEventListener('DOMContentLoaded', initKlaviyoForm)

</script>
  
  {% schema %}
    {
      "name": "Klaviyo Footer Form",
      "settings": [{
          "label": "List ID",
          "id": "klaviyo_list_id",
          "type": "text"
      }, {
          "label": "Disclaimer",
          "id": "disclaimer",
          "type": "richtext"
      }]
    }
  {% endschema %}
  