{% assign img = section.settings.background_image | img_url: '100x100' %}
{% assign img_lazy = img | replace: '_100x100', '_{width}x' %}

<div id="story_header" class="lazyload" style="background-image: url('{{ img }}');" data-src="{{ img_lazy }}">
  <div class="container text-right">
    <div class="row justify-content-end">
      <div class="col-md-4">
        {% assign logo = section.settings.logo | img_url: '50x50' %}
        {% assign logo_lazy = logo | replace: '_50x50', '_{width}x' %}
        <img
            src="{{ logo }}"
            data-src="{{ logo_lazy }}"
            data-sizes="auto"
            class="lazyload w-100" 
            alt="{{ section.settings.logo.alt }}"
            data-widths="[90, 180, 360, 720, 900, 1080, 1296, 1512, 1728, 2048]"
            data-aspectratio="{{ section.settings.logo.aspect_ratio }}"
        />
        <h1>{{ page.title }}</h1>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('lazybeforeunveil', function(e){
    var bg = e.target.getAttribute('data-src');
    if(bg){
      let bg_width = bg.replace("{width}", $(e.target).width());
      $(e.target).attr('data-bgset', bg_width);
    }
  });
</script>

{% schema %}
{
  "name": "Header",
  "settings": [ {
    "id": "background_image",
    "label": "Background Image",
    "type": "image_picker"
  }, {
    "id": "logo",
    "label": "Logo",
    "type": "image_picker"
  }]
}
{% endschema %}
